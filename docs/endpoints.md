- getAvailableObjects - вернуть json с собранными данными по объекту
    - Смотрим роль
        - если 0 - ССК
            - Выбираем не начатые объекты и объекты, где мы менеджер
        - если 1 - прораь
            - Собираем объекты, с которыми мы связаны
        - если 2 - гос контроль
            - Собираем объекты, с которыми мы связаны

- getObjectData - вернуть подробную инфу об объекте 
    - Проверить существование объекта
    - Проверить права на объект
    - Сформировать данные на основе прав 


- registerComment - создать нарущение/замечание
    - Проверить существование объекта
    - Проверить права на объект
    - Проверить права на создание типа (сск - замечания, гос контроль - нарушения)
    - Проверить гео в пакете на нахождение на объекте
    - Создать запись
    - Проверить остановочное ли
        - Если да - изменить статус объекта

- registerCommentFix
    - Проверить существование объекта
    - Проверить права на объект (связь)
    - Проверить роль (только прораб)
    - Проверить гео в пакете на нахождение на объекте
    - Создать запись

________

Надо что-то рещить с загрузкой файлов, но не уверен, что стоит тратить время пока.
Про что говорю: когда мы отправили с клиента файл, то мы загружаем его в систему, но он не может быть связан с создаваемым объектом, у которого нет id.
В системе с уроками я создавал фальшивый id, который потом заменял на реальный созданный. 
Как сделать тут не уверен, или предзапрос делать, или сохранять ответы загруженный файлов и передавать список id файлов в соответствуюещем json и связывать после создания.

_________


- registerFixVerification
    - Проверить существование объекта
    - Проверить права на объект
    - Проверить права на проверку типа (сск - замечания, гос контроль - нарушения)
    - записать данные 


- registrerLabRequest
    - Проверить существование объекта
    - Проверить права на объект (связь)
    - Проверить роль (только гос контроль)
    - Создать заявку на указанную партию указанного материала

{
   "$schema": "http://json-schema.org/draft-04/schema#",
   "title": "LabReq",
   "description": "",
   "type": "object",
  
   "properties": {
      "materialId": {
         "description": "ID материала",
         "type": "integer"
      },

      "shipmentId": {
         "description": "ID поставки",
         "type": "integer"
      }
   }
}

- shiftJobSchedule
    - Проверить существование объекта
    - Проверить права на объект
    - Проверить права на перенос (только сск)
    - создать запись в jobshift с одинаковым создателем и acceptor
    - Создать новый jobSchedule, свзязать старый через prev, привязать к sitejob

- registerJobShiftRequest
    - Проверить существование объекта
    - Проверить права на объект
    - Проверить права на заявку (только прораб)
    - Создать jobshift
{
   "$schema": "http://json-schema.org/draft-04/schema#",
   "title": "JobShiftDoc",
   "description": "",
   "type": "object",
  
   "properties": {
      "changedJob": {
         "description": "ID этапа работ",
         "type": "integer"
      },

      "newStart": {
         "description": "Новая дата начала работ",
         "type": "string"
      },

      "newEnd": {
         "description": "Новая дата оканчания работ",
         "type": "string"
      }
   }
}


- processJobShiftRequest
    - Проверить существование объекта
    - Проверить права на объект
    - Проверить права на действия с заявками (только ССК)
    - Что делаем
        - Принимаем
            - Аналогично shiftJobSchedule
        - Отклоняем
            - Ставим статус отказа
{
   "$schema": "http://json-schema.org/draft-04/schema#",
   "title": "JobShiftDoc",
   "description": "",
   "type": "object",
  
   "properties": {
      "requestId": {
         "description": "ID заявки на изменение",
         "type": "integer"
      },

      "result": {
         "description": "Действие с заявкой",
         "type": "integer"
      },

      "comment": {
         "description": "Комментарий",
         "type": "string"
      }
   }
}

- registerJobProgres - скорее всего прогрес будет регаться вместе с потреблением материала, потому эндпоинты объединятся с registerMatUsage
    - Проверить существование объекта
    - Проверить права на объект
    - Проверить права на регистрацию (только прораб)
    - Проверить гео в пакете на нахождение на объекте
    - Создать запись
    - Обработать список с материалом, каждый 
        - Проверить, что столько материала вообще есть
        - Создать запись
        - (связать с поставкой)

{
   "$schema": "http://json-schema.org/draft-04/schema#",
   "title": "JobShiftDoc",
   "description": "",
   "type": "object",
  
   "properties": {
      "jobId": {
         "description": "ID этапа работ",
         "type": "integer"
      },

      "comment": {
         "description": "Комментарий",
         "type": "string"
      },

      "volume": {
         "description": "Объем выполненной работы",
         "type": "number"
      },

      "geoData": {
        "type": "object",
            "properties": {
                "accuracy": {
                    "description": "Погрешность в метрах (https://docs.expo.dev/versions/latest/sdk/location/#locationobjectcoords)",
                    "type": "number"
                },
                "latitude": {
                    "description": "Широта",
                    "type": "number"
                },
                "longitude": {
                    "description": "Долгота",
                    "type": "number"
                },
            }
         
      }
   }
}

- registerJobFinished
    - Проверить существование объекта
    - Проверить права на объект
    - Проверить права на отметку (только прораб)
    - Проверить гео в пакете на нахождение на объекте
    - Пометить объект как unverified

- registerJobVerification
    - Проверить существование объекта
    - Проверить права на объект
    - Проверить права на отметку (только ССК)
    - Проверить гео в пакете на нахождение на объекте



- registerShipment
    - Проверить существование объекта
    - Проверить права на объект
    - Проверить права на регистрацию (только прораб)
    - Проверить гео в пакете на нахождение на объекте ?
    - Связать с поставщиком
    - Если пометка об отказе, пометить, сохранить, конец
    - На основе пакета создать набор shipped_mats

Принимаем сначала данные файла на OCR


- parseDocs
    - Принять фото
    - ????
    - Вернуть набор с набором товаров и потенциальным количеством и поставщиком?

- getFile
    - Проверить существование файла
    - Проверить права на объект
    - Проверить права на запрос (от контекста?)
    - Вернуть временную ссылку? Вренуть файл? 

- getChecklist
    - ????

- saveChecklist
    - ????